<body><h1>api webhooks webhook verification</h1><div data-reactroot="" id="__next"><div><aside></aside><div><div tabindex="-1"><main data-algolia="pageContent"><div><div><div><h1>Verify webhooks</h1><h4>API reference for verifying webhooks</h4><div></div></div></div></div><p>Plaid signs all outgoing webhooks so that you can verify the authenticity of any incoming webhooks to your application. A message signature is included in the <code>Plaid-Verification</code> header (Note: this is the canonical representation of the header field, but HTTP 1.x headers should be handled as <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2" rel="nofollow noopener noreferrer" target="_blank">case-insensitive</a>, HTTP 2 headers are always lowercase). The verification process is optional and is not required for your application to handle Plaid webhooks.</p><p>The verification process requires understanding JSON Web Tokens (JWTs) and JSON Web Keys (JWKs). More information about these specifications can be found at <a href="http://www.jwt.io" rel="nofollow noopener noreferrer" target="_blank">jwt.io</a>.</p><p>Libraries for interpreting and verifying JWKs and JWTs most likely exist in your preferred language. It is highly recommended that you utilize well-tested libraries rather than trying to implement these specifications from scratch.</p><a href="/docs/api/webhooks/webhook-verification/#steps-to-verify-webhooks"><h4>Steps to verify webhooks<span data-algolia="linkedHeadingAnchor" id="steps-to-verify-webhooks"></span></h4></a><a href="/docs/api/webhooks/webhook-verification/#extract-the-jwt-header"><h5>Extract the JWT header<span data-algolia="linkedHeadingAnchor" id="extract-the-jwt-header"></span></h5></a><p>Extract the Plaid-Verification HTTP header from any Plaid webhook (to get a webhook, see <a href="/docs/api/sandbox/#sandboxitemfire_webhook">firing webhooks in Sandbox</a>). The value of the Plaid-Verification header is a JWT, and will be referred to as "the JWT" in following steps.</p><p>Using your preferred JWT library, decode the JWT and extract the header without validating the signature. This functionality most likely exists in your preferred JWT library. An example JWT header is shown below.</p><div role="group"><div><label>JWT header</label><div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="-1"><div><pre><code><div><span>1</span><span>{</span><span></span></div><div><span>2</span><span>  </span><span>"alg"</span><span>:</span><span> </span><span>"ES256"</span><span>,</span><span></span></div><div><span>3</span><span>  </span><span>"kid"</span><span>:</span><span> </span><span>"bfbd5111-8e33-4643-8ced-b2e642a72f3c"</span><span>,</span><span></span></div><div><span>4</span><span>  </span><span>"typ"</span><span>:</span><span> </span><span>"JWT"</span><span></span></div><div><span>5</span><span></span><span>}</span></div></code></pre></div></div></div><p>Ensure that the value of the <code>alg</code> (algorithm) field in the header is <code>"ES256"</code>. Reject the webhook if this is not the case.</p><p>Extract the value corresponding to the <code>kid</code> (key ID) field. This will be used to retrieve the JWK public key corresponding to the private key that was used to sign this request.</p><a href="/docs/api/webhooks/webhook-verification/#get-the-verification-key"><h5>Get the verification key<span data-algolia="linkedHeadingAnchor" id="get-the-verification-key"></span></h5></a><p>Use the <a href="/docs/api/webhooks/webhook-verification/#get-webhook-verification-key"><code>/webhook_verification_key/get</code></a> endpoint to get the webhook verification key.</p><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_keyget"><h4><code>/webhook_verification_key/get</code><span data-algolia="linkedHeadingAnchor" id="webhook_verification_keyget"></span></h4></a><div data-algolia="schema"><a href="/docs/api/webhooks/webhook-verification/#get-webhook-verification-key"><h4>Get webhook verification key<span data-algolia="linkedHeadingAnchor" id="get-webhook-verification-key"></span></h4></a><p>Plaid signs all outgoing webhooks and provides JSON Web Tokens (JWTs) so that you can verify the authenticity of any incoming webhooks to your application. A message signature is included in the <code>Plaid-Verification</code> header.<br/>The <a href="/docs/api/webhooks/webhook-verification/#get-webhook-verification-key"><code>/webhook_verification_key/get</code></a> endpoint provides a JSON Web Key (JWK) that can be used to verify a JWT.</p><span data-algolia="schemaRouteHidden">webhook_verification_key/get</span><div><div><div><div><div><div><p><b>Request fields</b> and example</p></div></div></div><div></div></div></div></div><div><div><div><div><div><div><div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-request-client-id"><code data-algolia="schemaRowAttributeKey">client_id</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-request-client-id"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>Your Plaid API <code>client_id</code>. The <code>client_id</code> is required and may be provided either in the <code>PLAID-CLIENT-ID</code> header or as part of a request body.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-request-secret"><code data-algolia="schemaRowAttributeKey">secret</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-request-secret"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>Your Plaid API <code>secret</code>. The <code>secret</code> is required and may be provided either in the <code>PLAID-SECRET</code> header or as part of a request body.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-request-key-id"><code data-algolia="schemaRowAttributeKey">key_id</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-request-key-id"></span></a><div><small><span>required</span><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The key ID ( <code>kid</code> ) from the JWT header.</span></div></div></div></div></div></div></div></div><div><div><div><span id="content-switcher-unique-id-17">Select group for content switcher</span><div><div aria-labelledby="content-switcher-unique-id-17" role="radiogroup"><button aria-checked="true" role="radio" type="button"><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span><span>Current libraries</span></span></button><button aria-checked="false" role="radio" type="button"><span><span>Legacy libraries</span></span></button></div></div><div><div role="group"><div><label>Get webhook verification key</label><div><div><div><div><button aria-controls="dropdown-unique-id-18" aria-expanded="false" aria-haspopup="true" aria-label="Select Language" type="button"><span>Node</span><i><svg aria-hidden="true" height="24" role="presentation" width="24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"></path><path d="M12 14.06l-3.53-3.53 1.06-1.06L12 11.94l2.47-2.47 1.06 1.06z" fill="currentColor"></path></g></svg></i></button></div><div data-popper-escaped="true" data-popper-placement="top" data-popper-reference-hidden="true" role="tooltip"><span>Select Language</span></div></div><div id="dropdown-unique-id-18" role="menu"><ul><li><button aria-current="false" label="Curl" type="button" value="bash"><span><span>Curl</span></span></button></li><li><button aria-current="true" label="Node" type="button" value="node"><span><span>Node</span></span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></button></li><li><button aria-current="false" label="Python" type="button" value="python"><span><span>Python</span></span></button></li><li><button aria-current="false" label="Ruby" type="button" value="ruby"><span><span>Ruby</span></span></button></li><li><button aria-current="false" label="Java" type="button" value="java"><span><span>Java</span></span></button></li><li><button aria-current="false" label="Go" type="button" value="go"><span><span>Go</span></span></button></li></ul></div></div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="-1"><div><pre><code><div><span>1</span><span>const</span><span> request</span><span>:</span><span> </span><span>WebhookVerificationKeyGetRequest</span><span> </span><span>=</span><span> </span><span>{</span><span></span></div><div><span>2</span><span>  key_id</span><span>:</span><span> keyID</span><span>,</span><span></span></div><div><span>3</span><span></span><span>}</span><span>;</span><span></span></div><div><span>4</span><span></span><span>try</span><span> </span><span>{</span><span></span></div><div><span>5</span><span>  </span><span>const</span><span> response </span><span>=</span><span> </span><span>await</span><span> plaidClient</span><span>.</span><span>webhookVerificationKeyGet</span><span>(</span><span>request</span><span>)</span><span>;</span><span></span></div><div><span>6</span><span>  </span><span>const</span><span> key </span><span>=</span><span> response</span><span>.</span><span>data</span><span>.</span><span>key</span><span>;</span><span></span></div><div><span>7</span><span></span><span>}</span><span> </span><span>catch</span><span> </span><span>(</span><span>error</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>8</span><span>  </span><span>// handle error</span><span></span></div><div><span>9</span><span></span><span>}</span></div></code></pre></div></div></div></div></div></div></div></div></div></div></div><div data-algolia="schema"><span data-algolia="schemaRouteHidden">webhook_verification_key/get</span><div><div><div><div><div><div><p><b>Response fields</b> and example</p><button type="button">Collapse all<i><svg aria-hidden="true" height="24" role="presentation" width="24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"></path><path d="M14.48 14.51l-2.47-2.47-2.47 2.47-1.06-1.06 3.53-3.53 3.53 3.53z" fill="currentColor"></path></g></svg></i></button></div></div></div><div></div></div></div></div><div><div><div><div><div><div><div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key"><code data-algolia="schemaRowAttributeKey">key</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key"></span></a><div><small><span>object</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>A JSON Web Key (JWK) that can be used in conjunction with <a href="https://jwt.io/#libraries-io">JWT libraries</a> to verify Plaid webhooks</span></div><button type="button">Hide object<i><svg aria-hidden="true" height="24" role="presentation" width="24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"></path><path d="M14.48 14.51l-2.47-2.47-2.47 2.47-1.06-1.06 3.53-3.53 3.53 3.53z" fill="currentColor"></path></g></svg></i></button></div><div><div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-alg"><code data-algolia="schemaRowAttributeKey">alg</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-alg"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The alg member identifies the cryptographic algorithm family used with the key.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-crv"><code data-algolia="schemaRowAttributeKey">crv</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-crv"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The crv member identifies the cryptographic curve used with the key.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-kid"><code data-algolia="schemaRowAttributeKey">kid</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-kid"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The kid (Key ID) member can be used to match a specific key. This can be used, for instance, to choose among a set of keys within the JWK during key rollover.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-kty"><code data-algolia="schemaRowAttributeKey">kty</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-kty"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The kty (key type) parameter identifies the cryptographic algorithm family used with the key, such as RSA or EC.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-use"><code data-algolia="schemaRowAttributeKey">use</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-use"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The use (public key use) parameter identifies the intended use of the public key.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-x"><code data-algolia="schemaRowAttributeKey">x</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-x"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The x member contains the x coordinate for the elliptic curve point, provided as a base64url-encoded string of the coordinate's big endian representation.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-y"><code data-algolia="schemaRowAttributeKey">y</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-y"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The y member contains the y coordinate for the elliptic curve point, provided as a base64url-encoded string of the coordinate's big endian representation.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-created-at"><code data-algolia="schemaRowAttributeKey">created_at</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-created-at"></span></a><div><small><span>integer</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The timestamp when the key was created, in Unix time.</span></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-key-expired-at"><code data-algolia="schemaRowAttributeKey">expired_at</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-key-expired-at"></span></a><div><small><span>nullable</span><span>integer</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>The timestamp when the key expired, in Unix time.</span></div></div></div></div></div></div></div></div><div><div data-algolia="schemaRowTd"><header><a href="/docs/api/webhooks/webhook-verification/#webhook_verification_key-get-response-request-id"><code data-algolia="schemaRowAttributeKey">request_id</code><span data-algolia="schemaRowAnchor" id="webhook_verification_key-get-response-request-id"></span></a><div><small><span>string</span></small></div></header><div><div data-algolia="schemaRowDescription"><span>A unique identifier for the request, which can be used for troubleshooting. This identifier, like all Plaid identifiers, is case sensitive.</span></div></div></div></div></div></div></div></div><div><div><div role="group"><div><label>API Object</label><div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="-1"><div><pre><code><div><span>1</span><span>{</span><span></span></div><div><span>2</span><span>  </span><span>"key"</span><span>:</span><span> </span><span>{</span><span></span></div><div><span>3</span><span>    </span><span>"alg"</span><span>:</span><span> </span><span>"ES256"</span><span>,</span><span></span></div><div><span>4</span><span>    </span><span>"created_at"</span><span>:</span><span> </span><span>1560466150</span><span>,</span><span></span></div><div><span>5</span><span>    </span><span>"crv"</span><span>:</span><span> </span><span>"P-256"</span><span>,</span><span></span></div><div><span>6</span><span>    </span><span>"expired_at"</span><span>:</span><span> </span><span>null</span><span>,</span><span></span></div><div><span>7</span><span>    </span><span>"kid"</span><span>:</span><span> </span><span>"bfbd5111-8e33-4643-8ced-b2e642a72f3c"</span><span>,</span><span></span></div><div><span>8</span><span>    </span><span>"kty"</span><span>:</span><span> </span><span>"EC"</span><span>,</span><span></span></div><div><span>9</span><span>    </span><span>"use"</span><span>:</span><span> </span><span>"sig"</span><span>,</span><span></span></div><div><span>10</span><span>    </span><span>"x"</span><span>:</span><span> </span><span>"hKXLGIjWvCBv-cP5euCTxl8g9GLG9zHo_3pO5NN1DwQ"</span><span>,</span><span></span></div><div><span>11</span><span>    </span><span>"y"</span><span>:</span><span> </span><span>"shhexqPB7YffGn6fR6h2UhTSuCtPmfzQJ6ENVIoO4Ys"</span><span></span></div><div><span>12</span><span>  </span><span>}</span><span>,</span><span></span></div><div><span>13</span><span>  </span><span>"request_id"</span><span>:</span><span> </span><span>"RZ6Omi1bzzwDaLo"</span><span></span></div><div><span>14</span><span></span><span>}</span></div></code></pre></div></div></div></div></div></div></div></div><div data-testid="docs-feedback"><div><h5>Was this helpful?</h5><div><button role="button" type="button"><span><span><span> <!-- -->Yes</span></span></span></button><button role="button" type="button"><span><span><span> <!-- -->No</span></span></span></button></div></div><div></div></div></div><a href="/docs/api/webhooks/webhook-verification/#validate-the-webhook"><h5>Validate the webhook<span data-algolia="linkedHeadingAnchor" id="validate-the-webhook"></span></h5></a><p>Interpret the returned <code>key</code> as a JWK public key. Using your preferred JWT library, verify the JWT using the JWK. If the signature is not valid, reject the webhook. Otherwise, extract the payload of the JWT. It will look something like the JSON below.</p><div role="group"><div><label>JWT Payload</label><div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="-1"><div><pre><code><div><span>1</span><span>{</span><span></span></div><div><span>2</span><span>  </span><span>"iat"</span><span>:</span><span> </span><span>1560211755</span><span>,</span><span></span></div><div><span>3</span><span>  </span><span>"request_body_sha256"</span><span>:</span><span> </span><span>"bbe8e9..."</span><span></span></div><div><span>4</span><span></span><span>}</span></div></code></pre></div></div></div><p>Use the issued at time denoted by the <code>iat</code> field to verify that the webhook is not more than 5 minutes old. Rejecting outdated webhooks can help prevent replay attacks.</p><p>Extract the value of the <code>request_body_sha256</code> field. This will be used to check the integrity and authenticity of the webhook body.</p><p>Compute the SHA-256 of the webhook body and ensure that it matches what is specified in the <code>request_body_sha256</code> field of the validated JWT. If not, reject the webhook. It is best practice to use a constant time string/hash comparison method in your preferred language to prevent timing attacks.</p><div><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.75 9v5h-1.5V9h1.5zM12 17a1 1 0 100-2 1 1 0 000 2z" fill="currentColor"></path><path clip-rule="evenodd" d="M11.995 3.242a1.75 1.75 0 00-1.513.87v.002L2.874 17.108l-.001.002a1.75 1.75 0 001.52 2.64h15.213a1.75 1.75 0 001.52-2.64l-.002-.002L13.51 4.114l-.001-.002a1.75 1.75 0 00-1.513-.87zm-.125 1.533a.25.25 0 01.341.091l7.622 13.003.002.003a.25.25 0 01-.218.378H4.383a.25.25 0 01-.218-.378L11.777 4.87l.002-.003a.25.25 0 01.091-.09z" fill="currentColor" fill-rule="evenodd"></path></svg></i><div><p>Note that the <code>request_body_sha256</code> sent in the JWT payload is sensitive to the whitespace in the webhook body and uses a tab-spacing of 2. If the webhook body is stored with a tab-spacing of 4, the hash will not match.</p></div></div><a href="/docs/api/webhooks/webhook-verification/#caching-and-key-rotation"><h4>Caching and key rotation<span data-algolia="linkedHeadingAnchor" id="caching-and-key-rotation"></span></h4></a><p>It is recommended that your application caches the public key for a given key ID, but for no more than 24 hours. This reduces the likelihood of using an expired key to validate incoming webhooks.</p><p>It may be possible that a key rotation will take place. If your application encounters a webhook with a key ID that it does not have in its cache, it should make an API request to fetch the associated public key. In addition, your application must refetch any keys from the API that are currently in the cache but not yet expired. This helps to ensure that expired keys are not being used for live validation of webhooks by refreshing the <code>expired_at</code> field.</p><a href="/docs/api/webhooks/webhook-verification/#example-implementation"><h4>Example implementation<span data-algolia="linkedHeadingAnchor" id="example-implementation"></span></h4></a><p>The following code shows one example method that can be used to verify webhooks sent by Plaid and cache public keys.</p><div role="group"><div><label>Sample implementations for verifying a Plaid webhook</label><div><div><div><div><button aria-controls="dropdown-unique-id-19" aria-expanded="false" aria-haspopup="true" aria-label="Select Language" type="button"><span>Node</span><i><svg aria-hidden="true" height="24" role="presentation" width="24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z"></path><path d="M12 14.06l-3.53-3.53 1.06-1.06L12 11.94l2.47-2.47 1.06 1.06z" fill="currentColor"></path></g></svg></i></button></div><div data-popper-escaped="true" data-popper-placement="top" data-popper-reference-hidden="true" role="tooltip"><span>Select Language</span></div></div><div id="dropdown-unique-id-19" role="menu"><ul><li><button aria-current="false" label="Curl" type="button" value="bash"><span><span>Curl</span></span></button></li><li><button aria-current="true" label="Node" type="button" value="node"><span><span>Node</span></span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></button></li><li><button aria-current="false" label="Python" type="button" value="python"><span><span>Python</span></span></button></li><li><button aria-current="false" label="Ruby" type="button" value="ruby"><span><span>Ruby</span></span></button></li><li><button aria-current="false" label="Java" type="button" value="java"><span><span>Java</span></span></button></li><li><button aria-current="false" label="Go" type="button" value="go"><span><span>Go</span></span></button></li></ul></div></div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="0"><div><pre><code><div><span>1</span><span>const</span><span> compare </span><span>=</span><span> </span><span>require</span><span>(</span><span>'secure-compare'</span><span>)</span><span>;</span><span></span></div><div><span>2</span><span></span><span>const</span><span> jwt_decode </span><span>=</span><span> </span><span>require</span><span>(</span><span>'jwt-decode'</span><span>)</span><span>;</span><span></span></div><div><span>3</span><span></span><span>const</span><span> </span><span>JWT</span><span> </span><span>=</span><span> </span><span>require</span><span>(</span><span>'jose'</span><span>)</span><span>;</span><span></span></div><div><span>4</span><span></span><span>const</span><span> sha256 </span><span>=</span><span> </span><span>require</span><span>(</span><span>'js-sha256'</span><span>)</span><span>;</span><span></span></div><div><span>5</span><span></span><span>const</span><span> plaid </span><span>=</span><span> </span><span>require</span><span>(</span><span>'plaid'</span><span>)</span><span>;</span><span></span></div><div><span>6</span><span></span></div><div><span>7</span><span></span><span>// Cache for webhook validation keys.</span><span></span></div><div><span>8</span><span></span><span>const</span><span> </span><span>KEY_CACHE</span><span> </span><span>=</span><span> </span><span>new</span><span> </span><span>Map</span><span>(</span><span>)</span><span>;</span><span></span></div><div><span>9</span><span></span></div><div><span>10</span><span></span><span>const</span><span> plaidClient </span><span>=</span><span> </span><span>new</span><span> </span><span>plaid</span><span>.</span><span>Client</span><span>(</span><span>{</span><span></span></div><div><span>11</span><span>  clientID</span><span>:</span><span> process</span><span>.</span><span>env</span><span>.</span><span>CLIENT_ID</span><span>,</span><span></span></div><div><span>12</span><span>  secret</span><span>:</span><span> process</span><span>.</span><span>env</span><span>.</span><span>SECRET</span><span>,</span><span></span></div><div><span>13</span><span>  env</span><span>:</span><span> plaid</span><span>.</span><span>environments</span><span>.</span><span>sandbox</span><span>,</span><span></span></div><div><span>14</span><span></span><span>}</span><span>)</span><span>;</span><span></span></div><div><span>15</span><span></span></div><div><span>16</span><span></span><span>const</span><span> </span><span>verify</span><span> </span><span>=</span><span> </span><span>async</span><span> </span><span>(</span><span>body</span><span>,</span><span> headers</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span></div><div><span>17</span><span>  </span><span>const</span><span> signedJwt </span><span>=</span><span> </span><span>JSON</span><span>.</span><span>parse</span><span>(</span><span>headers</span><span>)</span><span>[</span><span>'plaid-verification'</span><span>]</span><span>;</span><span></span></div><div><span>18</span><span>  </span><span>const</span><span> decodedToken </span><span>=</span><span> </span><span>jwt_decode</span><span>(</span><span>signedJwt</span><span>)</span><span>;</span><span></span></div><div><span>19</span><span>  </span><span>// Extract the JWT header</span><span></span></div><div><span>20</span><span>  </span><span>const</span><span> decodedTokenHeader </span><span>=</span><span> </span><span>jwt_decode</span><span>(</span><span>signedJwt</span><span>,</span><span> </span><span>{</span><span> header</span><span>:</span><span> </span><span>true</span><span> </span><span>}</span><span>)</span><span>;</span><span></span></div><div><span>21</span><span>  </span><span>// Extract the kid value from the header</span><span></span></div><div><span>22</span><span>  </span><span>const</span><span> currentKeyID </span><span>=</span><span> decodedTokenHeader</span><span>.</span><span>kid</span><span>;</span><span></span></div><div><span>23</span><span></span></div><div><span>24</span><span>  </span><span>//If key not in cache, update the key cache</span><span></span></div><div><span>25</span><span>  </span><span>if</span><span> </span><span>(</span><span>!</span><span>KEY_CACHE</span><span>.</span><span>has</span><span>(</span><span>currentKeyID</span><span>)</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>26</span><span>    </span><span>const</span><span> keyIDsToUpdate </span><span>=</span><span> </span><span>[</span><span>]</span><span>;</span><span></span></div><div><span>27</span><span>    </span><span>KEY_CACHE</span><span>.</span><span>forEach</span><span>(</span><span>(</span><span>keyID</span><span>,</span><span> key</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span></div><div><span>28</span><span>      </span><span>// We will also want to refresh any not-yet-expired keys</span><span></span></div><div><span>29</span><span>      </span><span>if</span><span> </span><span>(</span><span>key</span><span>.</span><span>expired_at</span><span> </span><span>==</span><span> </span><span>null</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>30</span><span>        keyIDsToUpdate</span><span>.</span><span>push</span><span>(</span><span>keyID</span><span>)</span><span>;</span><span></span></div><div><span>31</span><span>      </span><span>}</span><span></span></div><div><span>32</span><span>    </span><span>}</span><span>)</span><span>;</span><span></span></div><div><span>33</span><span></span></div><div><span>34</span><span>    keyIDsToUpdate</span><span>.</span><span>push</span><span>(</span><span>currentKeyID</span><span>)</span><span>;</span><span></span></div><div><span>35</span><span></span></div><div><span>36</span><span>    </span><span>for</span><span> </span><span>(</span><span>const</span><span> keyID </span><span>of</span><span> keyIDsToUpdate</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>37</span><span>      </span><span>const</span><span> response </span><span>=</span><span> </span><span>await</span><span> plaidClient</span></div><div><span>38</span><span>        </span><span>.</span><span>webhookVerificationKeyGet</span><span>(</span><span>{</span><span></span></div><div><span>39</span><span>          key_id</span><span>:</span><span> keyID</span><span>,</span><span></span></div><div><span>40</span><span>        </span><span>}</span><span>)</span><span></span></div><div><span>41</span><span>        </span><span>.</span><span>catch</span><span>(</span><span>(</span><span>err</span><span>)</span><span> </span><span>=&gt;</span><span> </span><span>{</span><span></span></div><div><span>42</span><span>          </span><span>// decide how you want to handle unexpected API errors,</span><span></span></div><div><span>43</span><span>          </span><span>// e.g. retry later</span><span></span></div><div><span>44</span><span>          </span><span>return</span><span> </span><span>false</span><span>;</span><span></span></div><div><span>45</span><span>        </span><span>}</span><span>)</span><span>;</span><span></span></div><div><span>46</span><span>      </span><span>const</span><span> key </span><span>=</span><span> response</span><span>.</span><span>data</span><span>.</span><span>key</span><span>;</span><span></span></div><div><span>47</span><span>      </span><span>KEY_CACHE</span><span>.</span><span>set</span><span>(</span><span>keyID</span><span>,</span><span> key</span><span>)</span><span>;</span><span></span></div><div><span>48</span><span>    </span><span>}</span><span></span></div><div><span>49</span><span>  </span><span>}</span><span></span></div><div><span>50</span><span></span></div><div><span>51</span><span>  </span><span>// If the key ID is not in the cache, the key ID may be invalid.</span><span></span></div><div><span>52</span><span>  </span><span>if</span><span> </span><span>(</span><span>!</span><span>KEY_CACHE</span><span>.</span><span>has</span><span>(</span><span>currentKeyID</span><span>)</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>53</span><span>    </span><span>return</span><span> </span><span>false</span><span>;</span><span></span></div><div><span>54</span><span>  </span><span>}</span><span></span></div><div><span>55</span><span></span></div><div><span>56</span><span>  </span><span>// Fetch the current key from the cache.</span><span></span></div><div><span>57</span><span>  </span><span>const</span><span> key </span><span>=</span><span> </span><span>KEY_CACHE</span><span>.</span><span>get</span><span>(</span><span>currentKeyID</span><span>)</span><span>;</span><span></span></div><div><span>58</span><span></span></div><div><span>59</span><span>  </span><span>// Reject expired keys.</span><span></span></div><div><span>60</span><span>  </span><span>if</span><span> </span><span>(</span><span>key</span><span>.</span><span>expired_at</span><span> </span><span>!=</span><span> </span><span>null</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>61</span><span>    </span><span>return</span><span> </span><span>false</span><span>;</span><span></span></div><div><span>62</span><span>  </span><span>}</span><span></span></div><div><span>63</span><span></span></div><div><span>64</span><span>  </span><span>// Validate the signature and iat</span><span></span></div><div><span>65</span><span>  </span><span>try</span><span> </span><span>{</span><span></span></div><div><span>66</span><span>    </span><span>const</span><span> keyLike </span><span>=</span><span> </span><span>await</span><span> </span><span>JWT</span><span>.</span><span>importJWK</span><span>(</span><span>key</span><span>)</span><span>;</span><span></span></div><div><span>67</span><span>    </span><span>// This will throw an error if verification fails</span><span></span></div><div><span>68</span><span>    </span><span>const</span><span> </span><span>{</span><span> payload </span><span>}</span><span> </span><span>=</span><span> </span><span>await</span><span> </span><span>JWT</span><span>.</span><span>jwtVerify</span><span>(</span><span>signedJwt</span><span>,</span><span> keyLike</span><span>,</span><span> </span><span>{</span><span></span></div><div><span>69</span><span>      maxTokenAge</span><span>:</span><span> </span><span>'5 min'</span><span>,</span><span></span></div><div><span>70</span><span>    </span><span>}</span><span>)</span><span>;</span><span></span></div><div><span>71</span><span>  </span><span>}</span><span> </span><span>catch</span><span> </span><span>(</span><span>error</span><span>)</span><span> </span><span>{</span><span></span></div><div><span>72</span><span>    </span><span>return</span><span> </span><span>false</span><span>;</span><span></span></div><div><span>73</span><span>  </span><span>}</span><span></span></div><div><span>74</span><span></span></div><div><span>75</span><span>  </span><span>// Compare hashes.</span><span></span></div><div><span>76</span><span>  </span><span>const</span><span> bodyHash </span><span>=</span><span> </span><span>sha256</span><span>(</span><span>body</span><span>)</span><span>;</span><span></span></div><div><span>77</span><span>  </span><span>const</span><span> claimedBodyHash </span><span>=</span><span> decodedToken</span><span>.</span><span>request_body_sha256</span><span>;</span><span></span></div><div><span>78</span><span>  </span><span>return</span><span> </span><span>compare</span><span>(</span><span>bodyHash</span><span>,</span><span> claimedBodyHash</span><span>)</span><span>;</span><span></span></div><div><span>79</span><span></span><span>}</span><span>;</span></div></code></pre></div></div></div></main></div></div></div></div><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert"></p></next-route-announcer><div>
</div><div id="batBeacon879851463501"><img alt="" height="0" id="batBeacon981807812780" src="https://bat.bing.com/action/0?ti=25047304&amp;Ver=2&amp;mid=a4d6e993-d1f8-406f-a7ea-5e74f8030000&amp;sid=839d8000406811ee9647031f9910d79d&amp;vid=839d8d20406811ee8b5bc59b5329b4ac&amp;vids=0&amp;msclkid=N&amp;pi=0&amp;lg=en-US&amp;sw=5120&amp;sh=1440&amp;sc=24&amp;nwd=1&amp;tl=API%20-%20Webhook%20verification%20%7C%20Plaid%20Docs&amp;p=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;r=&amp;lt=355&amp;evt=pageLoad&amp;sv=1&amp;rn=442953" width="0"/><img alt="" height="0" id="batBeacon493053983999" src="https://bat.bing.com/action/0?ti=25047304&amp;Ver=2&amp;mid=a4d6e993-d1f8-406f-a7ea-5e74f8030000&amp;sid=839d8000406811ee9647031f9910d79d&amp;vid=839d8d20406811ee8b5bc59b5329b4ac&amp;vids=0&amp;msclkid=N&amp;ea=track&amp;el=DOCS_EVENT&amp;p=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;sw=5120&amp;sh=1440&amp;sc=24&amp;nwd=1&amp;evt=custom&amp;rn=104738" width="0"/></div><iframe height="0" id="universal_pixel_u0iai2i" src="https://insight.adsrvr.org/track/up?adv=4azo4ri&amp;ref=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;upid=u0iai2i&amp;upv=1.1.0" title="TTD Universal Pixel" width="0"></iframe><img height="1" src="https://t.co/i/adsct?bci=3&amp;eci=2&amp;event_id=c5b46d71-5aa4-4467-9516-66a8ea83af10&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=b6e67779-c9cb-4a93-b860-e6dfa918ac7a&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://analytics.twitter.com/i/adsct?bci=3&amp;eci=2&amp;event_id=c5b46d71-5aa4-4467-9516-66a8ea83af10&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=b6e67779-c9cb-4a93-b860-e6dfa918ac7a&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://t.co/i/adsct?bci=3&amp;eci=2&amp;event_id=22412ce0-7082-45dd-8c44-91236e28ac9b&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=b6e67779-c9cb-4a93-b860-e6dfa918ac7a&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://analytics.twitter.com/i/adsct?bci=3&amp;eci=2&amp;event_id=22412ce0-7082-45dd-8c44-91236e28ac9b&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=b6e67779-c9cb-4a93-b860-e6dfa918ac7a&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Fapi%2Fwebhooks%2Fwebhook-verification%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/></body>