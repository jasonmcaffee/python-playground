<body><h1>link duplicate items </h1><div data-reactroot="" id="__next"><div><aside></aside><div><div tabindex="-1"><main data-algolia="pageContent"><div><div><div><h1>Preventing duplicate Items</h1><h4>Prevent unnecessary billing and confusing application behavior</h4><div></div></div></div></div><div><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M1 0h24v24H1z" fill="none"></path><path d="M22.73 7.68a1.23 1.23 0 00-1.13-.17L17.25 9V6A1.25 1.25 0 0016 4.75H5.5A1.25 1.25 0 004.25 6v12a1.25 1.25 0 001.25 1.25H16A1.25 1.25 0 0017.25 18v-3l4.35 1.45a1.12 1.12 0 00.4.07 1.21 1.21 0 00.73-.24 1.23 1.23 0 00.52-1V8.69a1.23 1.23 0 00-.52-1.01zm-7 10.07h-10V6.25h10zm6-2.79l-4.5-1.5v-2.92L21.75 9zM9 16a1 1 0 10-1-1 1 1 0 001 1zm3 0a1 1 0 10-1-1 1 1 0 001 1z" fill="currentColor"></path></svg></i><div><p>Prefer to learn by watching? A <a href="https://youtu.be/TczdBk5z9eM" rel="nofollow noopener noreferrer" target="_blank">video guide</a> is available for this topic.</p></div></div><a href="/docs/link/duplicate-items/#how-duplicate-items-are-created"><h4>How duplicate Items are created<span data-algolia="linkedHeadingAnchor" id="how-duplicate-items-are-created"></span></h4></a><p>An <a href="https://plaid.com/docs/quickstart/glossary/#item" rel="nofollow noopener noreferrer" target="_blank">Item</a> represents a login at a financial institution. This login typically happens when an end user links an account (or several accounts) using <a href="https://plaid.com/docs/link/" rel="nofollow noopener noreferrer" target="_blank">Plaid Link</a>. A duplicate Item will be created if the end user logs into the same institution using the same credentials again using Plaid Link (in the same application), and if an access token is requested for the Item.</p><p>Duplicate Items can occur for multiple reasons. For example, a duplicate Item can occur if a user accidentally links the same account more than once, because they do not realize they already linked an account, or because their linked account is no longer working. Duplicate Items can also occur if a user intentionally links multiple Items for abusive purposes (for example, as part of an attempt to receive multiple sign-up bonuses or to evade a ban). </p><p>Duplicate Items can create confusing or unwanted behavior in your application and could result in being potentially billed for multiple Items. We recommend building safeguards in your application to help prevent end users from creating duplicate Items. In this article, we'll describe a few ways to prevent and detect Item duplication.</p><a href="/docs/link/duplicate-items/#preventing-duplicate-items"><h4>Preventing duplicate Items<span data-algolia="linkedHeadingAnchor" id="preventing-duplicate-items"></span></h4></a><a href="/docs/link/duplicate-items/#use-the-onsuccess-callback-metadata"><h5>Use the onSuccess callback metadata<span data-algolia="linkedHeadingAnchor" id="use-the-onsuccess-callback-metadata"></span></h5></a><p>The <a href="https://plaid.com/docs/link/web/#onsuccess" rel="nofollow noopener noreferrer" target="_blank"><code>onSuccess</code></a> callback is called when a user successfully links an Item using Plaid Link. This callback provides metadata that you can use to prevent duplicate Items from being created. One approach is to require a user login prior to launching Plaid Link so that you can retrieve existing Items associated with the user.</p><p>Then, before requesting an <code>access_token</code>, examine and compare the <code>onSuccess</code> callback metadata to the user's existing Items. You can compare a combination of the accountsâ€™ <code>institution_id</code>, account <code>name</code>, and account <code>mask</code> to determine whether an end user has previously linked an account to your application. Do not exchange a public token for an access token if you detect a duplicate Item.</p><div><div></div><div><p>While the <code>mask</code> value is usually the same as the last 4 digits of the account number, this is not the case at all institutions. Never detect duplicate Items by attempting to match a <code>mask</code> with an account number.</p></div></div><div role="group"><div><label>Sample onSuccess metadata schema</label><div><button role="button" type="button"><span><span><span><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M21.54 11.12l-5.66-5.66a1.24 1.24 0 00-1.76 0l-2.2 2.2-2-2a1.26 1.26 0 00-1.75 0l-5.5 5.5a1.21 1.21 0 000 1.75l5.5 5.5a1.21 1.21 0 001.75 0l2.05-2 2.2 2.2a1.23 1.23 0 001.76 0l5.66-5.66a1.24 1.24 0 00-.05-1.83zM9 17.13L3.87 12 9 6.87l1.85 1.85-2.39 2.4a1.24 1.24 0 000 1.76l2.39 2.4zm6 .17L9.7 12 15 6.7l5.3 5.3z" fill="currentColor"></path></svg></i><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"></path><path d="M10.03 17.09l-4.56-4.56 1.06-1.06 3.44 3.44 7.47-8.41 1.12 1-8.53 9.59z" fill="currentColor"></path></svg></i></span></span><span><span>Copy</span></span></span></button></div></div><div data-id="scroll-container" tabindex="-1"><div><pre><code><div><span>1</span><span>{</span><span></span></div><div><span>2</span><span>  institution</span><span>:</span><span> </span><span>{</span><span></span></div><div><span>3</span><span>    name</span><span>:</span><span> </span><span>'Wells Fargo'</span><span>,</span><span></span></div><div><span>4</span><span>    institution_id</span><span>:</span><span> </span><span>'ins_4'</span><span></span></div><div><span>5</span><span>  </span><span>}</span><span>,</span><span></span></div><div><span>6</span><span>  accounts</span><span>:</span><span> </span><span>[</span><span></span></div><div><span>7</span><span>    </span><span>{</span><span></span></div><div><span>8</span><span>      id</span><span>:</span><span> </span><span>'ygPnJweommTWNr9doD6ZfGR6GGVQy7fyREmWy'</span><span>,</span><span></span></div><div><span>9</span><span>      name</span><span>:</span><span> </span><span>'Plaid Checking'</span><span>,</span><span></span></div><div><span>10</span><span>      mask</span><span>:</span><span> </span><span>'0000'</span><span>,</span><span></span></div><div><span>11</span><span>      type</span><span>:</span><span> </span><span>'depository'</span><span>,</span><span></span></div><div><span>12</span><span>      subtype</span><span>:</span><span> </span><span>'checking'</span><span>,</span><span></span></div><div><span>13</span><span>      verification_status</span><span>:</span><span> </span><span>''</span><span></span></div><div><span>14</span><span>    </span><span>}</span><span>,</span><span></span></div><div><span>15</span><span>    </span><span>{</span><span></span></div><div><span>16</span><span>      id</span><span>:</span><span> </span><span>'9ebEyJAl33FRrZNLBG8ECxD9xxpwWnuRNZ1V4'</span><span>,</span><span></span></div><div><span>17</span><span>      name</span><span>:</span><span> </span><span>'Plaid Saving'</span><span>,</span><span></span></div><div><span>18</span><span>      mask</span><span>:</span><span> </span><span>'1111'</span><span>,</span><span></span></div><div><span>19</span><span>      type</span><span>:</span><span> </span><span>'depository'</span><span>,</span><span></span></div><div><span>20</span><span>      subtype</span><span>:</span><span> </span><span>'savings'</span><span></span></div><div><span>21</span><span>    </span><span>}</span><span></span></div><div><span>22</span><span>    </span><span>...</span><span></span></div><div><span>23</span><span>  </span><span>]</span><span>,</span><span></span></div><div><span>24</span><span>  link_session_id</span><span>:</span><span> </span><span>'79e772be-547d-4c9c-8b76-4ac4ed4c441a'</span><span></span></div><div><span>25</span><span></span><span>}</span></div></code></pre></div></div></div><p>For Items linked via <a href="https://plaid.com/docs/link/oauth/#introduction-to-oauth" rel="nofollow noopener noreferrer" target="_blank">OAuth</a> or <a href="https://plaid.com/docs/link/account-select-v2-migration-guide/" rel="nofollow noopener noreferrer" target="_blank">Account Selection v2</a>, note that duplicate Items are not always identical. For example, an Item may have a checking account linked, while its duplicate may have only a savings account linked. While this scenario is rare, if it becomes a problem for your use case, you can switch to using the <code>institution_id</code> field on a per-user basis to prevent duplicate Items and enforce that each user of your app not link multiple Items with the same institution. However, because this is a legitimate use case for some applications, it is not recommended as the primary means of detecting duplicate Items.</p><div><i><svg aria-hidden="true" role="presentation" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.75 9v5h-1.5V9h1.5zM12 17a1 1 0 100-2 1 1 0 000 2z" fill="currentColor"></path><path clip-rule="evenodd" d="M11.995 3.242a1.75 1.75 0 00-1.513.87v.002L2.874 17.108l-.001.002a1.75 1.75 0 001.52 2.64h15.213a1.75 1.75 0 001.52-2.64l-.002-.002L13.51 4.114l-.001-.002a1.75 1.75 0 00-1.513-.87zm-.125 1.533a.25.25 0 01.341.091l7.622 13.003.002.003a.25.25 0 01-.218.378H4.383a.25.25 0 01-.218-.378L11.777 4.87l.002-.003a.25.25 0 01.091-.09z" fill="currentColor" fill-rule="evenodd"></path></svg></i><div><p>Duplicate Items with certain OAuth institutions</p><p>For some institutions that use OAuth connections, including Chase and Charles Schwab, existing Items will be invalidated if an end user adds a second Item using the same credentials, at the point when the <code>onSuccess</code> callback is returned. For this reason, the <code>onSuccess</code> metadata approach cannot be used to prevent duplicate Items at these institutions. Instead, use alternative means of preventing duplicate Items, described below. If a duplicate Item is created, delete the old Item using <a href="/docs/api/items/#itemremove"><code>/item/remove</code></a>.</p></div></div><a href="/docs/link/duplicate-items/#implement-pre-link-messaging"><h5>Implement Pre-Link messaging<span data-algolia="linkedHeadingAnchor" id="implement-pre-link-messaging"></span></h5></a><p>A lightweight but effective method for preventing accidental duplicate Items from being created is by providing relevant messaging and information to end users before they engage with Plaid Link in your application. For example, displaying a list of accounts they've already connected to your application can help prevent end users from inadvertently linking the same accounts again.</p><a href="/docs/link/duplicate-items/#use-links-update-mode"><h5>Use Link's update mode<span data-algolia="linkedHeadingAnchor" id="use-links-update-mode"></span></h5></a><p>From time to time, an Item may become unhealthy due to entering the <code>ITEM_LOGIN_REQUIRED</code> state. Or, the Item may still be healthy, but you may want your end user to authorize additional accounts or permissions associated with the Item. When either of these scenarios happens, use <a href="/docs/link/update-mode/">Link in update mode</a> to refresh the Item instead of creating a new Item.</p><a href="/docs/link/duplicate-items/#example-implementation-preventing-accidental-duplicate-items"><h4>Example implementation: Preventing accidental duplicate Items<span data-algolia="linkedHeadingAnchor" id="example-implementation-preventing-accidental-duplicate-items"></span></h4></a><p>For an example that demonstrates how to prevent accidental duplicate Items, see the <a href="https://github.com/plaid/pattern" rel="nofollow noopener noreferrer" target="_blank">Plaid Pattern</a> sample app. Plaid Pattern implements simple server-side logic to check whether the user ID and institution ID pair already exist in the application database. If the pair exists, an access token will not be requested for this Item, thereby preventing a duplicate. In addition, a message is displayed to the end user informing them that they've already linked this Item. The relevant code can be found in <a href="https://github.com/plaid/pattern/blob/master/server/routes/items.js#L41-L49" rel="nofollow noopener noreferrer" target="_blank">/server/routes/items.js</a> and <a href="https://github.com/plaid/pattern/blob/master/server/db/queries/items.js#L73-L88" rel="nofollow noopener noreferrer" target="_blank">/server/db/queries/items.js</a>.</p><a href="/docs/link/duplicate-items/#identifying-existing-duplicate-items"><h4>Identifying existing duplicate Items<span data-algolia="linkedHeadingAnchor" id="identifying-existing-duplicate-items"></span></h4></a><p>To identify existing duplicate Items, use the same matching logic as described above, but retrieve this data via the <a href="/docs/api/accounts/#accountsget"><code>/accounts/get</code></a> endpoint instead of the <code>onSuccess</code> callback. Occasionally, the <code>mask</code> or <code>name</code> fields may be null, in which case you can compare <code>institution_id</code> and <code>client_user_id</code> as a fallback. After identifying duplicate Items, use the <a href="/docs/api/items/#itemremove"><code>/item/remove</code></a> endpoint to delete an Item.</p><p>If you are using Auth via <a href="/docs/api/products/auth/#authget"><code>/auth/get</code></a>, existing duplicate Items may be detected by using the account and routing number fields and looking for duplicates. Note that this method will not work for Chase Items, as Chase uses tokenized account numbers. If you wish to detect existing duplicate Items at Chase, you can use the <a href="/docs/api/accounts/#accounts-get-response-accounts-persistent-account-id"><code>persistent_account_id</code></a> field, which will be the same across duplicate instances of a Chase Item. This field is in beta; to request access, contact Support or your Account Manager. </p><a href="/docs/link/duplicate-items/#detecting-and-preventing-duplicate-items-across-user-accounts"><h4>Detecting and preventing duplicate Items across user accounts<span data-algolia="linkedHeadingAnchor" id="detecting-and-preventing-duplicate-items-across-user-accounts"></span></h4></a><p>When attempting to detect or prevent duplicate Items, your approach should depend on the type of duplicate Item you are trying to prevent. For example, you can often scope your search to either a single user's accounts, or to all accounts known to your application. If you are attempting to prevent accidental duplicate Items, you should scope the search to a single user; if you are attempting to detect or prevent abuse, it may make more sense to expand your search to all accounts that have been linked to your app. </p><p>Note that there can be legitimate use cases for the same financial institution account to be linked across multiple different user accounts (for example, family members who share a joint bank account, or employees of the same company who share access to a business account); depending on your use case, you may want to incorporate this data into a broader abuse detection framework rather than blocking all duplicate accounts.</p></main></div></div></div></div><next-route-announcer><p aria-live="assertive" id="__next-route-announcer__" role="alert"></p></next-route-announcer><div id="batBeacon591870721685"><img alt="" height="0" id="batBeacon524320418403" src="https://bat.bing.com/action/0?ti=25047304&amp;Ver=2&amp;mid=a73c89c6-293d-475a-8add-2b9301eb1ab7&amp;sid=839d8000406811ee9647031f9910d79d&amp;vid=839d8d20406811ee8b5bc59b5329b4ac&amp;vids=0&amp;msclkid=N&amp;pi=0&amp;lg=en-US&amp;sw=5120&amp;sh=1440&amp;sc=24&amp;nwd=1&amp;tl=Link%20-%20Preventing%20duplicate%20Items%20%7C%20Plaid%20Docs&amp;p=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;r=&amp;lt=519&amp;evt=pageLoad&amp;sv=1&amp;rn=326877" width="0"/><img alt="" height="0" id="batBeacon666611275150" src="https://bat.bing.com/action/0?ti=25047304&amp;Ver=2&amp;mid=a73c89c6-293d-475a-8add-2b9301eb1ab7&amp;sid=839d8000406811ee9647031f9910d79d&amp;vid=839d8d20406811ee8b5bc59b5329b4ac&amp;vids=0&amp;msclkid=N&amp;ea=track&amp;el=DOCS_EVENT&amp;p=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;sw=5120&amp;sh=1440&amp;sc=24&amp;nwd=1&amp;evt=custom&amp;rn=318954" width="0"/></div><div>
</div><iframe height="0" id="universal_pixel_u0iai2i" src="https://insight.adsrvr.org/track/up?adv=4azo4ri&amp;ref=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;upid=u0iai2i&amp;upv=1.1.0" title="TTD Universal Pixel" width="0"></iframe><img height="1" src="https://t.co/i/adsct?bci=3&amp;eci=2&amp;event_id=acdeb35d-4dc0-4f61-9403-ba9d8c155783&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=ef68bf32-5277-4a6f-a97e-0569f81ca556&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://analytics.twitter.com/i/adsct?bci=3&amp;eci=2&amp;event_id=acdeb35d-4dc0-4f61-9403-ba9d8c155783&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=ef68bf32-5277-4a6f-a97e-0569f81ca556&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://t.co/i/adsct?bci=3&amp;eci=2&amp;event_id=60f91f2a-7f47-490e-a572-8c04a89b4be8&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=ef68bf32-5277-4a6f-a97e-0569f81ca556&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/><img height="1" src="https://analytics.twitter.com/i/adsct?bci=3&amp;eci=2&amp;event_id=60f91f2a-7f47-490e-a572-8c04a89b4be8&amp;events=%5B%5B%22pageview%22%2C%7B%7D%5D%5D&amp;integration=advertiser&amp;p_id=Twitter&amp;p_user_id=0&amp;pl_id=ef68bf32-5277-4a6f-a97e-0569f81ca556&amp;tw_document_href=https%3A%2F%2Fplaid.com%2Fdocs%2Flink%2Fduplicate-items%2F&amp;tw_iframe_status=0&amp;tw_order_quantity=0&amp;tw_sale_amount=0&amp;txn_id=o5pi2&amp;type=javascript&amp;version=2.3.29" width="1"/></body>